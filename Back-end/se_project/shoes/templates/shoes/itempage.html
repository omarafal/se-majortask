{% extends 'shoes/base.html' %}
{% load static %}
{% block head %}
	<meta charset="UTF-8">
	<link href="https://fonts.googleapis.com/css?family=Oswald:400,600" rel="stylesheet">
	<link rel="stylesheet" href="{% static 'shoes/home.css' %}"/>
    <link href="{% static 'shoes/itempage.css' %}" rel="stylesheet" type="text/css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.1/css/all.min.css" rel="stylesheet">

    <meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><!--Google Icons-->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"><!--Bootstrap Icons-->
	<link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet"><!--Navbar/Slider-->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"><!--NavBar/Slider-->
{% endblock head %}

{% block content %}
<main>
    <div>
        {% for i in shoes %}
            <div class="container" style="margin-top:60px">
              <div class="product-image ">
                  <img src="/{{ i.img }}" alt="" class="product-pic">
                  <div class="dots">
                </div>
              </div>

              <div class="product-details shadow1">
                <header>
                  <h1 class="title">{{ i.name }}</h1>
                  <div class="colorCat">{{ i.color }}</div>
                  <div class="price"style="float:left;">
                    <span class="current">{{ i.price }}</span>
                  </div>
                </header>
                  <div class="color" style="margin-top: 60px">
                              {% if more_items %}
                                  <h5>select color:</h5>
                                  <ul style="margin: 0px">
                                  {% for j in more_items %}
                                      {% if j.color_hexa != "#000000" %}
                                          <a class="colors color-bdot1 active" style="margin: 20px 40px 20px -17px;  background-color: {{ j.color_hexa }};box-shadow: 0 0 4px 0px black, 0 0 1px 5px white, 0 0 10px 5px black" href="/item/{{ j.id }}"></a>
                                      {% else %}
                                          <a class="colors color-bdot1 active" style="margin: 20px 40px 20px -17px;  background-color: {{ j.color }};box-shadow: 0 0 4px 0px black, 0 0 1px 5px white, 0 0 10px 5px black" href="/item/{{ j.id }}"></a>
                                      {% endif %}
                                  {% endfor %}
                                  </ul>
                              {% else %}
                                  <h5>Available color:</h5>
                                  <ul style="margin: 0px">
                                  {% if i.color_hexa != "#000000" %}
                                      <li class="colors color-bdot1 active" style="margin: 20px 0px 20px -17px; background-color: {{ i.color_hexa }};box-shadow: 0 0 4px 0px black, 0 0 1px 5px white, 0 0 10px 5px black"></li>
                                  {% else %}
                                      <li class="colors color-bdot1 active" style="margin: 20px 0px 20px -17px; background-color: {{ i.color }};box-shadow: 0 0 4px 0px black, 0 0 1px 5px white, 0 0 10px 5px black"></li>
                                  {% endif %}
                                  </ul>
                              {% endif %}
                      </div>
                     <form method="POST" onsubmit="get_action(this)">
                      {% csrf_token %}
                      <div class="size" style="max-width: 50vw; margin-top: 20px; display: inline-flex">
                          <h5 id="size_text{{ i.id }}" style="max-width: 100px">select size:  <h5 id="size_choosen" style="max-width: 30px; font-size: 1.10rem"></h5></h5>
                          <span class="select-menu" id="{{ i.id }}" style="margin-top: -5px">
                              <div class="custom-select-trigger" id="B{{ i.id }}"></div>
                              <ul class="options" style="list-style-type: none; margin-top: 22px;margin-left: -30px;max-height: 200px" id="L{{ i.id }}">
                                  <h6 class="text-center">Select Size</h6>
                                  <li class="option"><span class="option-text">38</span></li>
                                  <li class="option"><span class="option-text">39</span></li>
                                  <li class="option"><span class="option-text">40</span></li>
                                  <li class="option"><span class="option-text">41</span></li>
                                  <li class="option"><span class="option-text">42</span></li>
                                  <li class="option"><span class="option-text">43</span></li>
                                  <li class="option"><span class="option-text">44</span></li>
                                  <li class="option"><span class="option-text">45</span></li>
                              </ul>
                          </span>
                      </div>
                      <script>
                          function myfunction(){
                              alert("Please Sign in :(");
                          }
                      </script>
                      <div class="footer1" style="margin-top: 50px" >
                          {% if user.is_authenticated %}
                                  <button type="submit">
                                      <img src="http://co0kie.github.io/codepen/nike-product-page/cart.png" alt="">
                                      <span>add to cart</span>
                                  </button>
                          {% else %}
                                  <button type="button" onclick="myfunction()">
                                      <img src="http://co0kie.github.io/codepen/nike-product-page/cart.png" alt="">
                                      <span>add to cart</span>
                                  </button>
                          {% endif %}
                          {% if messages %}
                              {% for message in messages %}
                                  <div class="alert alert" style="text-align: left">{{ message }}</div>
                              {% endfor %}
                          {% else %}
                              <div class="alert alert" style="text-align: left"><span id="msg_out"></span></div>
                          {% endif %}
                      </div>
                  </form>
              </div>
            </div>
        {% endfor %}
    </div>
</main>
{% endblock content %}

{% block additional %}
    <script type="text/javascript">
        const
            list = [],
            array = [],
            array2 = [],
            array3 = [],
            array4 = [];
        let j = 0;
        {% for i in shoes %}
            array[j] = document.getElementById("{{ i.id }}");
            array4[j] = $("#size_text{{ i.id }}");
            array3[j] = array[j].querySelectorAll(".option");
            array2[j] = $("#B{{ i.id }}");
            list[j] = $("#L{{ i.id }}");
            list[j].toggleClass("hide")
            j ++;
        {% endfor %}
        for (let x = 0; x < j; x++) {
            array2[x].on("click", function(){
                $('html').one('click',function() {
                    array[x].classList.remove("active");
                });
                array[x].classList.toggle("active")
                event.stopPropagation();
            });
            array4[x].on("click", function(){
                $('html').one('click',function() {
                    array[x].classList.remove("active");
                });
                array[x].classList.toggle("active")
                event.stopPropagation();
            });
            $('#size_choosen').on("click", function(){
                $('html').one('click',function() {
                    array[x].classList.remove("active");
                });
                array[x].classList.toggle("active")
                event.stopPropagation();
            });
            {% for i in shoes %}
                var url = '/add_product/{{ i.id }}/?sizeselect=';
                const url2 = '/item/{{ i.id }}';
            {% endfor %}
            var selected = '';
            array3[x].forEach((option) => {
                option.addEventListener("click", () => {
                    array[x].classList.remove("active");
                    option.classList.add("selected");
                    selected = option.textContent;
                    document.getElementById("size_choosen").innerHTML = option.textContent;
                });
            });
        }
        function get_action(form) {
            url += selected;
            form.action = url;
        }
    </script>
    <script>
        if (history.scrollRestoration) {
            history.scrollRestoration = 'manual';
        }
        else {
            window.onbeforeunload = function () {
                window.scrollTo(0, 0);
            }
        }
    </script>
{% endblock additional %}